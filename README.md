# JAWS-UG 関西女子会 [誰でも参加OK] AIで人を笑わせてみよう！ハンズオン 実行手順
2022/07/31に開催される JAWS-UG 関西女子会 [誰でも参加OK] AIで人を笑わせてみよう！ハンズオンの実行手順です。<br>
すべて実行が完了するまでに約１時間〜１時間半くらいかかります。<br>

- [イベントURL](https://jawsugkgirls.doorkeeper.jp/events/138088)

# ボケて電笑戦 Workshop 実行手順
## 0. 前提条件
- [上限緩和申請](https://github.com/aws-samples/bokete-denshosen/blob/main/LIMIT_INCREASE.md) がすべてクリアになっていること
- 笑わせる気が満点になっていること


## 1. AWSマネジメントコンソールでログイン
- AWSマネジメントコンソールからご自身のアカウントにログインしてください。

## 2. Amazon S3を起動
- 左上のサービス検索に「S3」と入力し、 **Amazon S3** を起動してください。
- 起動したら、好きな名前のS3バケットを作成してください。
- バケットは、上限緩和申請時に利用したリージョンを指定してください。
- S3バケット名は後で使いますのでメモしておいてください。（※１）

## 3. Amazon SageMakerを起動
- 左上のサービス検索に「SageMaker」と入力し、 **Amazon SageMaker** を起動してください。
- 起動したら、上限緩和したリージョンになってることを確認してください。

## 4. Amazon SageMaker Studioのセットアップ
### 4.1. Amazon SageMaker Studioを起動
- 左メニューのコントロールパネルにある、「Studio」をクリックしてください。
- 右ページの「SageMaker Studioを起動」をクリックしてください。

## 5. Amazon SageMaker Studioドメインの作成
- 「高速セットアップ(1分)」を選択してください
- 「ユーザープロファイル」の名前はなんでもいいので、わかりやすい名前にしておいてください。
    - そのままでもOK
- ロールは「新しいロールの作成」を選択してください。
- 「IAMロールを作成する」画面が表示されることを確認してください。
- 画面内で、「特定のS3バケット」を選択し、（※１）でメモしたバケット名を入力してください。
- 右下にある「ロールの作成」をクリックしてください。
- 右下の「送信」ボタンをクリックしてください。
- 「VPCを選択」ダイアログが表示されますので、ご自身ですでに作成済みもしくはデフォルトのVPCを選択してください。<br>するとサブネットの指定が必要なのでパブリックサブネットを指定してください。<br>右下に「保存して続行」ボタンがアクティブになるので、クリックしてください。
<br><br>
作成が完了するまで数分かかるので、ご歓談。<br>
このときに、「ValidationException」がいっぱい出ますが問題ありません。<br>
画面をリロードしてください。<br>

## 6. Amazon SageMaker Studioの起動
上記で作成が完了したら、以下の操作を行います。<br>
- コントロールパネル内の「ユーザー」に先ほど作成したユーザー名が表示されていますので、「アプリケーションを起動▼」をクリックし、「Studio」をクリックしてください。
<br>
SageMakerのロゴ的なものがぐるぐるしていると思います。<br>
表示されるまで数分かかるので、ご歓談<br>

## 7. IAM Roleの更新
Amazon SageMaker Studioを起動している間に、「5. Amazon SageMaker Studioドメインの作成」で作った IAM Role を更新します。
<br>
- 別タブでIAMを開きます
- 左メニューの「アクセス管理」→「ロール」をクリックしてください
- ロール名の検索で「AmazonSageMaker-ExecutionRole-202207」と入力すると多分一つだけ出てきますので、そのリンクをクリックしてください
- 「許可」タブの「許可ポリシー」の右側にある「許可を追加」→「ポリシーをアタッチ」をクリックしてください
- 検索窓で「S3」と入力し、表示された中にある「AmazonS3FullAccess」の左のチェックボックにチェックを入れて、右下の「ポリシーをアタッチ」ボタンをクリックしてください

## 8. プログラムのダウンロード
- Amazon SageMaker Studioが起動するとIDE的なものが表示されます。
- 表示されたら、以下の操作を行ってください。

- 左のアイコンにGitのマーク（カタカナの「イ」を逆にしたようなマーク）をクリックしてください
- 「Clone a Repository」ボタンをクリックしてください
- 以下のURLを入力して、「CLONE」ボタンをクリックしてください
    - https://github.com/aws-samples/bokete-denshosen.git
- 左のアイコンのファイル・フォルダのマークをクリックしてください
- 以下の操作をして、JupyterNotebookを開いてください
    - 「notebook」フォルダをダブルクリック
    - 「keras_baseline」フォルダをダブルクリック
    - 「bokete_keras_on_sagemaker.ipynb」ファイルをダブルクリック

## 9. 実行
後は実行していくだけになります。<br>
最初カーネルの起動をしてるのでちょっと待っててください。<br>
しばらくしたらIDE上部に表示されてるセットアップ中の文言が消えたら、「▶」をクリックしていきます。<br>
<br>
実行には、約30〜60分かかりますので、ご歓談<br>
「Cleanup」の直前に画像が表示されれば、完了です！<br>
画像の上にボケた文字が出ています。<br>
※ **画像を変えて実行する場合は、「Cleanup」から下は実行しないでください**<br>
<br>
画像を変えて再実行をする場合は、<br>
「You can find your favorite image from https://bokete.jp/boke/select, then copy&paste the image url.」<br>
で検索した次の行のコメントアウトを変更し、ここから「▶」をクリックしてください<br>

## 10.最後に削除
以下の手順で削除していきます。<br>
**削除しないと料金が継続的にかかりますので、ご注意ください。**<br>
時間は30分程度かかります。<br>
<br>
１．「Cleanup」から最後まで「▶」をクリックしてください<br>
　　実行が終わったら、Amazon SageMaker Studioのタブは閉じてください<br>
２．Amazon SageMaker Studioのコントロールパネルのユーザー名のリンクをクリックしてください<br>
３．「tensorflow....」の右の「アプリケーションを削除」をクリックしてください<br>
　　「はい、アプリケーションを削除します」ボタンをクリックし、その下のテキストフィールドに「削除」と記入し、「削除」ボタンをクリックしてください<br>
　　結構時間かかります(15分くらい)<br>
　　あまり時間がかかった場合、画面をリロードしてください。ステータスが「Deleted」になっていればOKです。<br>
４．「default」の右の「アクション▼」→「削除」をクリックしてください<br>
　　「はい、アプリケーションを削除します」ボタンをクリックし、その下のテキストフィールドに「削除」と記入し、「削除」ボタンをクリックしてください<br>
　　結構時間かかります(10分くらい)<br>
５．右下の「編集」ボタンをクリックしてください<br>
６．「ユーザーを削除」ボタンをクリックしてください<br>
　　「はい、ユーザーを削除します」をクリックし、その下のテキストフィールドに「削除」と記入し、「削除」ボタンをクリックしてください<br>
７．Amazon SageMaker Studioのコントロールパネルの右側の「歯車」マークをクリックしてください<br>
８．「ドメインを削除」ボタンをクリックしてください<br>
　　「はい、Domainを削除します」をクリックし、その下のテキストフィールドに「削除」と記入し、「削除」ボタンをクリックしてください<br>
９． [AWSマネジメントコンソール / EFS](https://ap-northeast-1.console.aws.amazon.com/efs/home?region=ap-northeast-1#/file-systems)を開きます<br>
　　一つだけ表示されてる左側のラジオボタンをクリックし、「削除」ボタンをクリックしてください<br>
　　ダイアログに書かれたファイルシステムのIDを入力して、「確認」ボタンをクリックしてください<br>
１０．「2. Amazon S3を起動」で作成したS3バケットを削除します。<br>
　　削除前にバケット内のオブジェクトを消してから、S３バケットの削除をしてください<br>

**EOF**
